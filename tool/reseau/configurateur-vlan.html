<!-- Generated by Copilot -->
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configurateur de VLAN</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 0;
        }
        .container {
            width: 80%;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .form {
            display: flex;
            flex-direction: column;
            border: black 1px solid;
            border-radius: 10px;
            margin: 10px;
            padding: 5px;
        }
        label {
            margin: 10px;
            color: #555;
        }
        input, select {
            margin: 0 10px;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .button {
            padding: 10px 20px;
            background-color: #007BFF;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .button:hover {
            background-color: #0056b3;
        }
        .removeVlan {
            background-color: #dc3545;
        }
        .removeVlan:hover {
            background-color: #bd2130;
        }
        .output {
            margin-top: 20px;
            position: relative;
            display: block; /* Assure que chaque ligne occupe toute la largeur */
            background-color: #2d2d2d; /* Fond noir mignon pour le thème sombre */
            color: #f8f8f2; /* Texte clair pour la lisibilité */
            padding: 0.2em 0.4em; /* Un peu d'espace autour pour l'aération */
            border-radius: 5px; /* Coins arrondis tout mignons */
            font-family: 'Fira Code', 'Courier New', monospace; /* Typo de code élégante */
            white-space: pre; /* Conserve les espaces et sauts de ligne */
            width: 100%; /* Assure que le fond s'étend jusqu'au bout de la ligne */
            box-sizing: border-box; /* Inclut le padding et la bordure dans la largeur totale */
        }
        #ctrlC {
            position: absolute;
            top: 0.5em; /* Positionné en haut avec un léger espacement */
            right: 0.5em; /* Aligné à droite avec un petit espace */
        }
        #ctrlC button {
            background-color: #ff5c5c; /* Fond mignon du bouton */
            color: white; /* Texte en blanc */
            padding: 0.5em 1em; /* Espace autour pour un bouton confortable */
            border: none; /* Pas de bordure */
            border-radius: 5px; /* Coins arrondis mignons */
            cursor: pointer; /* Curseur qui indique que c'est cliquable */
            display: flex; /* Pour aligner l'icône et le texte ensemble */
            align-items: center; /* Centre verticalement l'icône et le texte */
            box-shadow: 1px 1px 5px rgba(0, 0, 0, 0.2); /* Ombre pour effet de relief */
            transition: background-color 0.3s ease; /* Animation de transition douce pour le survol */
        }

        #ctrlC button:hover {
            background-color: #ff3030; /* Couleur plus foncée au survol */
        }

        #ctrlC svg {
            width: 1em; /* Taille de l'icône */
            height: 1em; /* Garde l'icône carrée */
            margin-right: 0.5em; /* Espace entre l'icône et le texte */
            fill: white; /* Remplit l'icône en blanc */
            transition: width 0.3s ease; /* Animation de transition douce pour le survol */
        }
        a {
            color: #333;
            font-weight: bold;
        }

    </style>
</head>
<body>
    <div class="container">
        <a href="/tool/reseau/index.html">retour au outils réseau</a>
        <h1>Configurateur de VLAN</h1>
        <div id="vlanDiv">
  
        </div>
        <button class="button" id="addVlan">ajouter un nouvaux vlan</button>
        <button class="button" id="generate">Générer la commande</button>

        <code class="output" id="commandOutput"><div id="ctrlC"><button onclick="copyToClipboard()"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M384 336l-192 0c-8.8 0-16-7.2-16-16l0-256c0-8.8 7.2-16 16-16l140.1 0L400 115.9 400 320c0 8.8-7.2 16-16 16zM192 384l192 0c35.3 0 64-28.7 64-64l0-204.1c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1L192 0c-35.3 0-64 28.7-64 64l0 256c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-32-48 0 0 32c0 8.8-7.2 16-16 16L64 464c-8.8 0-16-7.2-16-16l0-256c0-8.8 7.2-16 16-16l32 0 0-48-32 0z"/></svg>Copier la commande</button></div> 
            sortie du générateur de commande

        </code>
</div>

    <script>
        let vlanID = []
        document.getElementById('generate').addEventListener('click', function(event) {
            console.log('click')
            let commandOutput = document.getElementById('commandOutput')
            let commande = `
vlan database
            `
            //pour chaque vlan
            for (let i = 0; i < vlanID.length; i++) {
                let vlanId = document.getElementById(`vlanId-${i}`).value
                let vlanName = document.getElementById(`vlanName-${i}`).value
                //supprime les espaces
                if (vlanName.includes(' '))
                    alert('Le nom du VLAN ' + vlanId + ' contient des espaces, il seront automatiquement supprimés')
                vlanName = vlanName.replace(/\s/g, '')
                commande += `
    vlan ${vlanId} name ${vlanName}
                `
            }
            commande += `
exit
configure terminal
            `
            let vlanIDConflic = []
            for (let i = 0; i < vlanID.length; i++) {
                let vlanId = document.getElementById(`vlanId-${i}`).value
              
                let typePort = document.getElementById(`typePort-${i}`).value
                let vlanRangeFrom = document.getElementById(`vlanRange-${i}-from`).value
                let vlanRangeTo = document.getElementById(`vlanRange-${i}-to`).value || vlanRangeFrom
                // si un des champs est vide
                if (!vlanId || !typePort || !vlanRangeFrom || !vlanRangeTo) {
                    alert('Veuillez remplir tous les champs')
                    return
                }
                //verifie si la plage de port est deja utilisé ou si l'ID du vlan est deja utilisé
                if (vlanIDConflic.some(vlan => vlan.vlanId == vlanId)) {
                    alert('Le VLAN ' + vlanId + ' est déjà utilisé')
                    return
                }
                if (vlanIDConflic.some(vlan => vlan.vlanRangeFrom <= vlanRangeFrom && vlan.vlanRangeTo >= vlanRangeFrom)) {
                    alert('La plage de port pour le VLAN ' + vlanId + ' est en conflit avec un autre VLAN')
                    return
                }
                vlanIDConflic.push({vlanId, vlanRangeFrom, vlanRangeTo})
                //test si la plage de port est de 1 port ou plus et que for est plus petit que to
                if (vlanRangeFrom > vlanRangeTo) {
                    alert('La plage de port pour le VLAN ' + vlanId + ' est incorrecte')
                    return
                }
                if (vlanRangeFrom == vlanRangeTo) {
                    commande += `
    interface ${typePort}${vlanRangeFrom}
        switchport mode access
        switchport access vlan ${vlanId}
    exit
                    `
                    continue
                }
                commande += `
    interface range ${typePort}${vlanRangeFrom} - ${vlanRangeTo}
        switchport mode access
        switchport access vlan ${vlanId}
    exit
                `
            }
            commande += `
exit
(write memory)
            `
            console.log(commande)
            commandOutput.innerHTML = commande

        });
        document.getElementById('addVlan').addEventListener('click', creatVlan)
        function creatVlan(){
            const vlanDiv = document.getElementById("vlanDiv")
            const addDiv = document.createElement('div')
            addDiv.id = `vlanForm-${vlanID.length}`
            addDiv.className = 'form'
            addDiv.innerHTML = `
                <div>
                    <label for="vlanId-${vlanID.length}">ID du VLAN :</label>
                    <input type="number" id="vlanId-${vlanID.length}" name="vlanId" required>
                </div>
                <div>
                    <label for="vlanName-${vlanID.length}">Nom du VLAN :</label>
                    <input type="text" id="vlanName-${vlanID.length}" name="vlanName" required>
                </div>
                <div>
                    <label for="typePprt-${vlanID.length}">Type de port :</label>
                    <select id="typePort-${vlanID.length}" name="typePort" required>
                        <option value="FastEthernet0/">FastEthernet0/</option>
                        <option value="GigabitEthernet0/">GigabitEthernet0/</option>
                    </select>
                <div>
                <div>
                    <label for="vlanRange-${vlanID.length}">Plage de ports :</label>
                    <input type="number" id="vlanRange-${vlanID.length}-from" name="vlanRange" required>
                    <label for="vlanRange-${vlanID.length}-to">à</label>
                    <input type="number" id="vlanRange-${vlanID.length}-to" name="vlanRange" required>
                </div>
                <div style="display: flex; justify-content: center;">
                    <button class="button removeVlan" id="removeVlan-${vlanID.length}" onclick="removeVlan(${vlanID.length})">Supprimer</button>
                </div>
            `
            vlanDiv.appendChild(addDiv)
            document.getElementById(`vlanId-${vlanID.length}`).focus()
            vlanID.push(vlanID.length)
        }
        creatVlan()
        function removeVlan(id){
            const vlanForm = document.getElementById(`vlanForm-${id}`)
            vlanForm.remove()
            vlanID = vlanID.filter(vlan => vlan !== id)
            console.log(vlanID)
        }
        function alert(message){
            //affiche une popup rouge avec le message en gros
            const cover = document.createElement('div')
            cover.style = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.5);
                z-index: 999;
            `
            const alertDiv = document.createElement('div')
            alertDiv.style = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: #dc3545;
                color: #fff;
                padding: 20px;
                border-radius: 10px;
                z-index: 1000;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            `
            alertDiv.innerHTML = `
                <h2>${message}</h2>
                <button onclick="document.body.removeChild(this.parentElement.parentElement)">OK</button>
            `
            cover.appendChild(alertDiv)
            document.body.appendChild(cover)
        }
        function copyToClipboard() {
            const commandOutput = document.getElementById('commandOutput')
            const el = document.createElement('textarea');
            el.value = commandOutput.innerText;
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
            //change la taille du svg pour montrer que le texte a été copié
            const svg = document.querySelector('#ctrlC svg')
            svg.style.width = '1.2em'
            svg.style.height = '1.2em'
            setTimeout(() => {
                svg.style.width = '1em'
                svg.style.height = '1em'
            }, 0.3 * 1000)
        }

    </script>
</body>
</html>